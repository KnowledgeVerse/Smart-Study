<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Smart Study Library</title>
    <link rel="stylesheet" href="style.css" />
    <link
      href="https://unpkg.com/boxicons@2.1.4/css/boxicons.min.css"
      rel="stylesheet"
    />
    <link
      rel="stylesheet"
      href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css"
    />
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600&family=Poppins:wght@400;600&display=swap" rel="stylesheet">
  </head>
  <body>
  <!-- Animated Background Container -->
  <div id="theme-background"></div>

  <!-- Glass Sign-In Modal -->
  <div id="loginModal" class="login-modal">
    <div class="login-box">
      <i class="bx bx-x" id="closeLoginModal"></i>
      <h2>Sign In</h2>
      <form id="loginForm">
        <input type="text" id="loginUser" placeholder="Username" required />
        <div style="position: relative">
          <input
            type="password"
            id="loginPass"
            placeholder="Password"
            required
          />
          <i
            class="bx bx-show-alt show-pass"
            id="togglePass"
            style="
              position: absolute;
              right: 10px;
              top: 50%;
              transform: translateY(-50%);
              cursor: pointer;
              color: #ccc;
            "
          ></i>
        </div>
        <button type="submit">Login</button>
      </form>
      <span
        id="loginError"
        style="color: red; font-size: 0.9rem; margin-top: 10px; display: none"
        >Invalid credentials</span
      >
    </div>
  </div>

  <!-- About Modal -->
  <div id="aboutModal" class="login-modal">
    <div class="login-box" style="width: 500px; max-width: 90%">
      <i class="bx bx-x" id="closeAboutModal"></i>
      <h2>About Smart Study</h2>
      <p style="color: #fff; line-height: 1.6; text-align: center">
        Smart Study offers comprehensive learning resources for
        <strong>National Boards (NCERT, CBSE, ICSE)</strong> and
        <strong>State Boards (Bihar, UP, MP)</strong>, along with
        <strong>Comics, Story Books, and GK & Competitive</strong> sections.
        This platform is designed to help students study smarter, explore
        knowledge deeply, and prepare effectively for exams on one smart,
        simple, and easy-to-use platform.
      </p>
    </div>
  </div>

  <!-- Contact Modal -->
  <div id="contactModal" class="login-modal">
    <div class="login-box" style="width: 400px; max-width: 90%">
      <i class="bx bx-x" id="closeContactModal"></i>
      <h2>Contact Us</h2>
      <form id="contactForm">
        <input type="text" id="contactName" placeholder="Your Name" required />
        <input
          type="email"
          id="contactEmail"
          placeholder="Your Email"
          required
        />
        <textarea
          id="contactMessage"
          placeholder="Your Message"
          rows="5"
          required
        ></textarea>
        <button type="submit">Send Message</button>
      </form>
    </div>
  </div>

  <!-- Retry Modal -->
  <div id="retryModal" class="login-modal" style="z-index: 2000">
    <div class="login-box" style="width: 320px; text-align: center">
      <i
        class="bx bx-error-circle"
        style="font-size: 3rem; color: #ff4d4d; margin-bottom: 10px"
      ></i>
      <h3 style="color: white; margin-bottom: 10px">Action Failed</h3>
      <p id="retryMessage" style="color: #ddd; margin-bottom: 20px">
        Something went wrong.
      </p>
      <div style="display: flex; gap: 10px; justify-content: center">
        <button id="confirmRetryBtn" style="background: var(--primary)">
          Retry
        </button>
        <button id="cancelRetryBtn" style="background: #555">Cancel</button>
      </div>
    </div>
  </div>

  <!-- Edit Book Modal -->
  <div id="editBookModal" class="login-modal" style="z-index: 2001">
    <div class="login-box" style="width: 400px">
      <i class="bx bx-x" id="closeEditModal"></i>
      <h2>Edit Book</h2>
      <form id="editBookForm">
        <input type="hidden" id="editBookId" />

        <label style="color: white; font-size: 0.9rem">Name</label>
        <input type="text" id="editBookName" required />

        <label style="color: white; font-size: 0.9rem">Category</label>
        <select
          id="editBookCategory"
          style="
            width: 100%;
            padding: 10px;
            margin: 5px 0 10px;
            border-radius: 8px;
            border: none;
            outline: none;
          "
        >
          <!-- Options populated by JS -->
        </select>

        <label style="color: white; font-size: 0.9rem">Class</label>
        <input type="text" id="editBookClass" required />

        <label style="color: white; font-size: 0.9rem">Subject</label>
        <input type="text" id="editBookSubject" required />

        <button type="submit" style="margin-top: 15px">Save Changes</button>
      </form>
    </div>
  </div>

  <!-- Bulk Edit Modal -->
  <div id="bulkEditModal" class="login-modal" style="z-index: 2002">
    <div class="login-box" style="width: 350px">
      <i class="bx bx-x" id="closeBulkEditModal"></i>
      <h2>Bulk Edit Category</h2>
      <p style="color: #ddd; font-size: 0.9rem; margin-bottom: 15px">
        Selected Books: <span id="bulkSelectedCount">0</span>
      </p>
      <form id="bulkEditForm">
        <label style="color: white; font-size: 0.9rem">New Category</label>
        <select
          id="bulkEditCategory"
          style="
            width: 100%;
            padding: 10px;
            margin: 5px 0 15px;
            border-radius: 8px;
            border: none;
            outline: none;
          "
        >
          <!-- Options populated by JS -->
        </select>
        <button type="submit">Update All</button>
      </form>
    </div>
  </div>

  <section id="draftSection" style="display: none; margin-top: 2rem">
    <h3>üìÅ Draft Books (Admin)</h3>
    <div id="draftList"></div>
  </section>

    <main class="main">
      <header class="top-bar">
        <div class="top-bar-container">
          <!-- Left Section: Logo + Dropdown -->
          <div class="header-left">
            <div class="logo-dropdown">
              <img
                src="logo/top-bar-logo.png"
                alt="Smart Study Logo"
                class="top-bar-logo"
                id="mainLogo"
              />
              <i
                class="bx bx-chevron-down dropdown-arrow"
                id="dropdownArrow"
              ></i>
            </div>

            <div class="search-wrapper" id="searchWrapper">
              <button class="search-icon-btn" id="searchIconBtn">
                <i class="bx bx-search"></i>
              </button>
              <div class="search-box-container" id="searchBoxContainer">
                <input type="text" id="bookSearch" placeholder="" />
                <i class="bx bx-x" id="closeSearch"></i>
              </div>
            </div>

            <div class="dropdown-menu" id="dropdownMenu">
              <!-- Dropdown Search -->
              <div class="dropdown-search-wrapper">
                <i class="bx bx-search"></i>
                <input
                  type="text"
                  id="categorySearch"
                  placeholder="Filter categories..."
                />
              </div>

              <!-- All Categories -->
              <div
                class="all-categories-wrapper"
                style="display: flex; align-items: stretch"
              >
                <div
                  class="dropdown-item"
                  onclick="expandAllSubmenus(event)"
                  style="cursor: pointer; flex: 1"
                >
                  <i class="bx bx-grid-alt"></i> All Categories
                </div>
                <div
                  class="dropdown-item"
                  onclick="collapseAllSubmenus(event)"
                  style="
                    cursor: pointer;
                    border-left: 1px solid rgba(0, 0, 0, 0.1);
                  "
                  title="Collapse All"
                >
                  <i class="bx bx-chevron-up"></i>
                </div>
              </div>

              <!-- Pre-School with Subcategories -->
              <div class="dropdown-group">
                <div
                  class="dropdown-item category-header has-submenu"
                  onclick="toggleSubmenu(event, 'preschool-submenu')"
                >
                  <i class="bx bx-baby-carriage"></i> Pre-School
                  <i class="bx bx-chevron-right submenu-arrow"></i>
                </div>
                <div class="submenu" id="preschool-submenu">
                  <a href="#" data-cat="PreNursery" class="dropdown-item"
                    ><i class="bx bx-star"></i> Pre-Nursery</a
                  >
                  <a href="#" data-cat="Nursery" class="dropdown-item"
                    ><i class="bx bx-sun"></i> Nursery</a
                  >
                  <a href="#" data-cat="LKG" class="dropdown-item"
                    ><i class="bx bx-pencil"></i> LKG</a
                  >
                  <a href="#" data-cat="UKG" class="dropdown-item"
                    ><i class="bx bx-book-reader"></i> UKG</a
                  >
                </div>
              </div>

              <!-- National Board with Subcategories -->
              <div class="dropdown-group">
                <div
                  class="dropdown-item category-header has-submenu"
                  onclick="toggleSubmenu(event, 'national-submenu')"
                >
                  <i class="bx bx-book"></i> National Board
                  <i class="bx bx-chevron-right submenu-arrow"></i>
                </div>
                <div class="submenu" id="national-submenu">
                  <a href="#" data-cat="NCERT" class="dropdown-item">
                    <i class="bx bx-book-bookmark"></i> NCERT
                  </a>
                  <a href="#" data-cat="CBSE" class="dropdown-item">
                    <i class="bx bx-book-content"></i> CBSE
                  </a>
                  <a href="#" data-cat="ICSE" class="dropdown-item">
                    <i class="bx bx-book-heart"></i> ICSE / ISC
                  </a>
                </div>
              </div>

              <!-- State Board with Subcategories -->
              <div class="dropdown-group">
                <div
                  class="dropdown-item category-header has-submenu"
                  onclick="toggleSubmenu(event, 'state-submenu')"
                >
                  <i class="bx bx-library"></i> State Board
                  <i class="bx bx-chevron-right submenu-arrow"></i>
                </div>
                <div class="submenu" id="state-submenu">
                  <a href="#" data-cat="Bihar" class="dropdown-item">
                    <i class="bx bx-map"></i> Bihar Board
                  </a>
                  <a href="#" data-cat="UP" class="dropdown-item">
                    <i class="bx bx-map-alt"></i> UP Board
                  </a>
                  <a href="#" data-cat="MP" class="dropdown-item">
                    <i class="bx bx-map-pin"></i> MP Board
                  </a>
                </div>
              </div>

              <!-- Comics with Subcategories -->
              <div class="dropdown-group">
                <div
                  class="dropdown-item category-header has-submenu"
                  onclick="toggleSubmenu(event, 'comics-submenu')"
                >
                  <i class="bx bx-mask"></i> Comics
                  <i class="bx bx-chevron-right submenu-arrow"></i>
                </div>
                <div class="submenu" id="comics-submenu">
                  <a href="#" data-cat="KidsComics" class="dropdown-item">
                    <i class="bx bx-child"></i> Kids Comics
                  </a>
                  <a href="#" data-cat="IndianClassics" class="dropdown-item">
                    <i class="bx bx-temple"></i> Indian Classics
                  </a>
                  <a href="#" data-cat="International" class="dropdown-item">
                    <i class="bx bx-globe"></i> International Comics
                  </a>
                  <a href="#" data-cat="Learning" class="dropdown-item">
                    <i class="bx bx-brain"></i> Learning Comics
                  </a>
                </div>
              </div>

              <!-- Story Books with Subcategories -->
              <div class="dropdown-group">
                <div
                  class="dropdown-item category-header has-submenu"
                  onclick="toggleSubmenu(event, 'stories-submenu')"
                >
                  <i class="bx bx-book-open"></i> Story Books
                  <i class="bx bx-chevron-right submenu-arrow"></i>
                </div>
                <div class="submenu" id="stories-submenu">
                  <a href="#" data-cat="KidsStories" class="dropdown-item">
                    <i class="bx bx-baby"></i> Kids Stories
                  </a>
                  <a href="#" data-cat="MoralStories" class="dropdown-item">
                    <i class="bx bx-heart"></i> Moral Stories
                  </a>
                  <a href="#" data-cat="FolkTales" class="dropdown-item">
                    <i class="bx bx-home-heart"></i> Folk Tales
                  </a>
                  <a href="#" data-cat="ClassicStories" class="dropdown-item">
                    <i class="bx bx-book-reader"></i> Classic Stories
                  </a>
                  <a href="#" data-cat="ShortStories" class="dropdown-item">
                    <i class="bx bx-bookmark"></i> Short Stories
                  </a>
                </div>
              </div>

              <!-- GK & Competitive with Subcategories -->
              <div class="dropdown-group">
                <div
                  class="dropdown-item category-header has-submenu"
                  onclick="toggleSubmenu(event, 'gk-submenu')"
                >
                  <i class="bx bx-brain"></i> GK & Competitive
                  <i class="bx bx-chevron-right submenu-arrow"></i>
                </div>
                <div class="submenu" id="gk-submenu">
                  <a href="#" data-cat="GK" class="dropdown-item">
                    <i class="bx bx-lightbulb"></i> GK
                  </a>
                  <a href="#" data-cat="Competitive" class="dropdown-item">
                    <i class="bx bx-target-lock"></i> Competitive Exams
                  </a>
                  <a href="#" data-cat="SchoolLevel" class="dropdown-item">
                    <i class="bx bx-school"></i> School Level
                  </a>
                </div>
              </div>

              <!-- My Downloads -->
              <a href="#" id="myDownDropdown" class="dropdown-item">
                <i class="bx bx-download"></i> My Downloads
              </a>

              <!-- Admin Section -->

              <div class="admin-only" style="display: none">
                <hr
                  style="
                    margin: 8px 0;
                    border: none;
                    height: 1px;
                    background: rgba(0, 0, 0, 0.1);
                  "
                />

                <div
                  class="dropdown-item"
                  onclick="openUploadPage()"
                  style="cursor: pointer"
                >
                  <i class="bx bx-cloud-upload"></i> Upload
                </div>

                <div
                  class="dropdown-item"
                  onclick="openDraftUploadPage()"
                  style="cursor: pointer"
                >
                  <i class="bx bx-folder-open"></i> Draft Upload
                </div>

                <div
                  class="dropdown-item"
                  id="btnRescanLibMain"
                  style="cursor: pointer"
                >
                  <i class="bx bx-refresh"></i> Rescan Library
                </div>
              </div>
            </div>
          </div>

          <!-- Center Section: Branding -->
          <div class="header-brand">
            <img
              src="logo/top-bar-logo.png"
              alt="Smart Study Logo"
              class="top-bar-logo"
            />
            <h1 class="gradient-text">Smart Study</h1>
            <img src="logo/logo.png" alt="Smart Study Logo" class="logo" />
          </div>

          <!-- Right Section: Search + Actions -->
          <div class="header-right">
            <div class="header-actions">
              <!-- Unified User Menu Trigger -->
              <div class="user-menu-container" id="userMenuContainer">
                <div class="user-profile-icon" id="userProfileIcon">
                  <img src="logo/logo.png" alt="User" class="nav-user-logo" />
                </div>

                <!-- Dropdown Menu -->
                <div class="profile-menu" id="userDropdownMenu">
                  <!-- Header for logged in user -->
                  <div
                    class="profile-menu-header"
                    id="menuUserHeader"
                    style="display: none"
                  >
                    <p>Admin User</p>
                    <span>admin@smartstudy.com</span>
                    <hr />
                  </div>

                  <!-- Sign In Option (Visible when logged out) -->
                  <a href="#" class="profile-menu-item" id="menuSignIn">
                    <i class="bx bx-log-in-circle"></i> Sign In
                  </a>

                  <!-- Logged In Options (Hidden by default) -->
                  <div id="loggedInOptions" style="display: none">
                    <a href="#" class="profile-menu-item"
                      ><i class="bx bx-user"></i> Profile</a
                    >
                    <a href="#" class="profile-menu-item"
                      ><i class="bx bx-cog"></i> Settings</a
                    >
                  </div>

                  <!-- Common Options -->
                  <a href="#" class="profile-menu-item" id="menuAbout"
                    ><i class="bx bx-info-circle"></i> About Smart Study</a
                  >
                  <a href="#" class="profile-menu-item" id="menuContact"
                    ><i class="bx bx-envelope"></i> Contact Us</a
                  >

                  <div class="profile-menu-item">
                    <i class="bx bx-moon"></i> Dark Mode
                    <label class="switch">
                      <input type="checkbox" id="darkModeToggle" />
                      <span class="slider round"></span>
                    </label>
                  </div>

                  <!-- Logout (Visible when logged in) -->
                  <div id="logoutOptionWrapper" style="display: none">
                    <hr />
                    <a href="#" class="profile-menu-item" id="menuLogout"
                      ><i class="bx bx-log-out"></i> Logout</a
                    >
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>
      </header>

      <div class="scroll-content">
        <section class="class-selector" id="classSelector">
          <button data-class="all">All Books</button>
          <button data-class="preschool" class="active">Pre-School</button>
          <button data-class="1">Class 1</button>
          <button data-class="2">Class 2</button>
          <button data-class="3">Class 3</button>
          <button data-class="4">Class 4</button>
          <button data-class="5">Class 5</button>
          <button data-class="6">Class 6</button>
          <button data-class="7">Class 7</button>
          <button data-class="8">Class 8</button>
          <button data-class="9">Class 9</button>
          <button data-class="10">Class 10</button>
          <button data-class="11">Class 11</button>
          <button data-class="12">Class 12</button>
        </section>

        <section class="subject-filter" id="subjectFilter"></section>

        <section class="book-grid" id="bookGrid"></section>

        <!-- Pagination Controls -->
        <div
          id="paginationControls"
          class="pagination-container"
          style="
            display: none;
            justify-content: center;
            gap: 15px;
            margin: 30px 0;
          "
        >
          <button id="prevPageBtn" class="btn-pagination">
            <i class="bx bx-chevron-left"></i> Previous
          </button>
          <span
            id="pageIndicator"
            style="
              display: flex;
              align-items: center;
              font-weight: bold;
              color: var(--text);
            "
            >Page 1</span
          >
          <button id="nextPageBtn" class="btn-pagination">
            Next <i class="bx bx-chevron-right"></i>
          </button>
        </div>
      </div>

      <footer class="wave-footer">
        <!-- Wave SVG -->
        <div class="waves-container">
          <svg class="waves" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"
          viewBox="0 24 150 28" preserveAspectRatio="none" shape-rendering="auto">
            <defs>
              <path id="gentle-wave" d="M-160 44c30 0 58-18 88-18s 58 18 88 18 58-18 88-18 58 18 88 18 v44h-352z" />
            </defs>
            <g class="parallax">
              <use xlink:href="#gentle-wave" x="48" y="0" fill="#7AA2F7" />
              <use xlink:href="#gentle-wave" x="48" y="3" fill="#4A69BD" />
              <use xlink:href="#gentle-wave" x="48" y="5" fill="#0A2540" />
            </g>
          </svg>
        </div>

        <div class="footer-content">
          <div class="footer-top-row">
            <div class="footer-left">
              <button id="footerBackToTopBtn" class="footer-btn">Back to Top ‚Üë</button>
            </div>
            
            <div class="footer-right">
              <h3>Follow Me</h3>
              <div class="social-links">
                <a href="https://www.facebook.com/lalkamal" target="_blank" aria-label="Facebook">
                  <i class="fab fa-facebook"></i>
                </a>
                <a href="https://www.instagram.com/lalkamal" target="_blank" aria-label="Instagram">
                  <i class="fab fa-instagram"></i>
                </a>
                <a href="https://twitter.com/lalkaml007" target="_blank" aria-label="Twitter">
                  <i class="fab fa-x-twitter"></i>
                </a>
              </div>
            </div>
          </div>

          <div class="footer-bottom-row">
            <div class="visitor-counter">
              <i class='bx bx-show'></i> Visitors: <span id="visitorCount">1012</span>
            </div>
            <p>¬© <strong>Lal Kamal</strong>. All Rights Reserved.</p>
          </div>
        </div>
      </footer>
    </main>

    <!-- Bulk Actions Bar (Fixed Bottom) -->
    <div id="bulkActionsBar" class="bulk-actions-bar" style="display: none">
      <div class="bulk-info">
        <span id="bulkCounter">0</span> books selected
      </div>
      <div class="bulk-buttons">
        <button id="btnBulkEdit" class="btn-bulk-action">
          <i class="bx bx-edit"></i> Edit Category
        </button>
        <button id="btnBulkCancel" class="btn-bulk-action cancel">
          <i class="bx bx-x"></i> Cancel
        </button>
      </div>
    </div>

    <!-- Back to Top Button -->
    <button id="backToTopBtn" title="Back to Top">
      <i class="bx bx-up-arrow-alt"></i>
    </button>

    <!-- Toast Container -->
    <div id="toastContainer" class="toast-container"></div>

    <script src="script.js"></script>
</html>
